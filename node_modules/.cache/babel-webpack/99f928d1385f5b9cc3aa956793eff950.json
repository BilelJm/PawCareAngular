{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet LoginComponent = class LoginComponent {\n  constructor(authService, storageService, router) {\n    this.authService = authService;\n    this.storageService = storageService;\n    this.router = router;\n    this.form = {\n      username: null,\n      password: null\n    };\n    this.isLoggedIn = false;\n    this.isLoginFailed = false;\n    this.errorMessage = '';\n    this.roles = [];\n  }\n\n  ngOnInit() {\n    if (this.storageService.isLoggedIn()) {\n      this.isLoggedIn = true;\n      this.roles = this.storageService.getUser().roles;\n    }\n  }\n\n  onSubmit() {\n    const {\n      username,\n      password\n    } = this.form;\n    this.authService.login(username, password).subscribe({\n      next: data => {\n        this.storageService.saveUser(data);\n        this.isLoginFailed = false;\n        this.isLoggedIn = true;\n        const user = this.storageService.getUser();\n        this.roles = user.roles;\n        console.log('User:', user);\n        console.log('Roles:', user.roles);\n\n        if (this.storageService.getUser().roles.includes('ROLE_ADMIN')) {\n          // navigate to the desired route\n          this.router.navigate(['/admin/users']);\n          console.log(this.storageService.getUser().roles);\n        } else if (this.roles.includes('ROLE_CLIENT') || this.roles.includes('ROLE_VETERINARY')) {\n          // navigate to the desired route\n          this.router.navigate(['']);\n          console.log(this.storageService.getUser().roles);\n        }\n      },\n      error: err => {\n        this.errorMessage = err.error.message;\n        this.isLoginFailed = true;\n        console.log(\"login failed\");\n      }\n    });\n  }\n\n  reloadPage() {\n    window.location.reload();\n  }\n\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html'\n})], LoginComponent);\nexport { LoginComponent };","map":null,"metadata":{},"sourceType":"module"}